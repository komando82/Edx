<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="https://unpkg.com/react@16/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js" crossorigin></script>

    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">

        class App extends React.Component {
            constructor() {
                super();

                this.workMin = 2
                this.workSec = 15

                this.breakMin = 1
                this.breakSec = 3

                this.state = {
                    workTimeSec: this.workSec,
                    breakTimeSec: this.breakSec,
                    isPaused: false,
                    breakTime: false,
                };
            }

            componentDidMount = () => {
                this.int = setInterval(() => this.countDown(), 1000)
            };

            componentDidUpdate = (prevProps, prevState, snapshot) => {
                if (this.state.isPaused !== prevState.isPaused) {
                    if (this.state.isPaused) {
                        clearInterval(this.int)
                    } else {
                        this.int = setInterval(() => this.countDown(), 1000)
                    }
                }
            };

            countDown() {
                let sec

                if (!this.state.breakTime) {
                    sec = this.state.workTimeSec - 1
                    this.setState({ workTimeSec: sec })

                    if (sec < 0) {
                        this.setState({ 
                            breakTime: !this.state.breakTime,
                            breakTimeSec: this.breakSec
                        });
                    }
                } else {
                    sec = this.state.breakTimeSec - 1
                    this.setState({ breakTimeSec: sec })

                    if (sec < 0) {
                        this.setState({ 
                            breakTime: !this.state.breakTime,
                            workTimeSec: this.workSec
                        });
                    }
                }

                console.log(sec)
            }

            pauseCountDown = () => {
                if (this.state.isPaused) {
                    console.log("start")
                    this.setState({ isPaused: false })
                } else {
                    console.log("pause")
                    this.setState({ isPaused: true })
                }
            };

            resetCountDown = () => {
                console.log("reset")

                this.resetCounterHelper()
            };

            workTimeChange = (e) => {
                let inpValue = parseInt(e.target.value);
                // console.log(inpValue)
                if (inpValue >= 0) {
                    this.workSec = inpValue
                } else {
                    this.workSec = 0
                }

                this.resetCounterHelper()
            }

            breakTimeChange = (e) => {
                let inpValue = parseInt(e.target.value)
                
                if (inpValue >= 0) {
                    this.breakSec = inpValue
                } else {
                    this.breakSec = 0
                }

                this.resetCounterHelper()
            }

            resetCounterHelper = () => {
                this.setState({ 
                    isPaused: true,
                    workTimeSec: this.workSec,
                    breakTime: false 
                });
            }

            addZeroToNumberLowwerThanTen(num) {
                if (num < 10) {
                    return `0${num}`
                } else {
                    return num
                }
            }

            render() {
                return (
                    <div>
                        <h1>{!this.state.breakTime ? 'Work Timer'.toUpperCase() : 'Break Timer'.toUpperCase()}</h1>
                        <p>Work time seconds: {this.addZeroToNumberLowwerThanTen(this.workSec)}</p>
                        <p>Break time seconds: {this.addZeroToNumberLowwerThanTen(this.breakSec)}</p>
                        <button onClick={this.pauseCountDown}>{this.state.isPaused ? 'Start' : 'Pause'}</button>
                        <button onClick={this.resetCountDown}>Reset</button>
                        <div>
                            <span>{this.addZeroToNumberLowwerThanTen(!this.state.breakTime ? this.state.workTimeSec : this.state.breakTimeSec)}</span>
                        </div>
                        <div>
                            Work Time: 
                            Mins: <input type="text" />
                            Secs: <input type="text" value={this.workSec} onChange={this.workTimeChange} />
                        </div>
                        <div>
                            Break Time: 
                            Mins: <input type="text"/>
                            Secs: <input type="text" value={this.breakSec} onChange={this.breakTimeChange} />
                        </div>
                    </div>
                );
            }
        }

        const rootElement = document.getElementById("root");
        ReactDOM.render(<App />, rootElement);

    </script>
</body>
</html>